<div id="back_link">&laquo;&nbsp;<a href="javascript:load_content('docs')">Back to Documentation</a></div>

<h1>FAQ</h1>
<br/>

<h4 class="loud">Which namespaces are virtualized? Is that selectable?</h4>
<p>
The goal of Singularity is to run an application within a contained
environment such as it was not contained. Thus there is a balance between
what to seperate and what not to seperate. At present the virtualized
namespaces are process, mount points, and certain parts of the contained
file system.
</p>
<p>
When you run your Singularity container, you may find that the process
IDs start with 1 (one) and increment from there. You will also find that
while the file system is contained starting with '/' (root), you can have
access outside the container via your starting path. This means that
relative paths will resolve outside the container, and fully qualified
paths will resolve inside the container.
</p>
<p>
To achieve this behavior, you will find that several Linux namespaces are
seperated (PIDS, file systems and descriptors, mounts, and root file
system). These can be enabled or disabled by the build and what namespaces
the host system supports as well as through envrionment variables.
</p>


<h4 class="loud">How does Singularity relate/differ from Shifter?</h4>
<p>
NERSC (like most HPC centers) are feeling the pressure from users asking
for support for containers, specifically Docker. Due to the architecture
of Docker it is very difficult (if not impossible) to properly and
securely implement in a multi-tenent HPC environment. Shifter is NERSC's
implementation to provide a Docker compatible front-end interface to
their extreme scale HPC resources. It is system/resource specific in
that you must import an existing container (from Docker, Singularity,
or other), to the host/shifter implementation.
</p>
<p>
Singularity on the other hand does not leverage the Docker workflow and
targets a different premise - Mobility of Compute. This makes the
integration of Singularity non-HPC specific (even though it works very
well with HPC) and allows the image to become the primary unit of
mobility (you can share and operate directly on Singularity images).
</p>


<h4 class="loud">How does Singulairty relate/differ from Docker?</h4>
<p>
Docker has been used for a variety of purposes, but it is designed as a
platform to provide replicatable, network service virtualation. Because of
this basic assumption and design model, it makes it difficult to implement
on shared HPC platforms (and thus Singularity was born). Additionally,
Docker supports the notion of emulating full operating system enviornments
including user context escalation.
</p>
<p>
Singularity on the other hand does not support user escalation or context
changes, nor does it have a root owned daemon process mananging the
container namespaces. It also exec's the process workflow inside the
container and seemlessly redirects all IO in and out of the container
directly between the enviornments. This makes doing things like MPI, X11
forwarding, and other kinds of work tasks trivial for Singularity.
</p>



<h4 class="loud">How does Singulairty relate/differ from statically compiled binaries?</h4>
<p>
Statically compiled binaries are a good comparasion to what Singularity can do
for a single program because it will package up all of the dynamic libraries
and package them into a single executable (intrepreted) format.
</p>
<p>
But because Singularity is actually wrapping operating system files in to a
container, you can do much more with it... Such as include other files,
scripts, workflows, pipe lines, data, and multi program processes and package
them into a single portable executable format.
</p>


<h4 class="loud">Can you edit/modity a Singularity container once it has been instantiated?</h4>
<p>
Yes, if you call it with the -w/--writable flag. (e.g. 'singularity shell --writable Container.img').
</p>


<h4 class="loud">Can multiple applications be packaged into one Singularity Container?</h4>
<p>
Yes! You can even create entire pipe lines and work flows using many
applications, binaries, scripts, etc.. Look into the RunScript bootstrap
definition option to define what happens when a Singularity container is
run (note: you can accomplish this by also creating an executable file
within your container at /singularity and when the container is executed
directly or via the 'run' command, this will get executed).
</p>


<h4 class="loud">Are Singularity containers kernel dependent?</h4>
<p>
No, never. But sometimes yes.
</p>
<p>
Singularity is using standard container principals and methods so if you
are leveraging any kernel version specific or external patches/module
functionality (e.g. OFED), then yes there maybe kernel dependencies you will
need to consider.
</p>
<p>
Luckily most people that would hit this are people that are using Singularity
to interoperate with an HPC (High Performance Computing) system where there
are highly tuned interconnects and file systems you wish to make effecient
use of. In this case, See the documentation of MPI with Singularity.
</p>
<p>
There is also some level of glibc forward compatibility that must be taken
into consideration for any container system. For example, I can take a 
Centos-5 container and run it on Centos-7, but I can not take a Centos-7
container and run it on Centos-5.
</p>
<p>
note: If you require kernel dependent features, a container platform is
probably not the right solution for you.
</p>


<h4 class="loud">How are external filesystems and paths handled in a Singularity Container?</h4>
<p>
Because Singularity is based on container principals, when an application
is run from within a Singularity container it's default view of the file
system is different from how it is on the host system. This is what allows the
envrionment to be portable. This means that root ('/') inside the container
is different from the host!
</p>
<p>
Singularity automatically tries to resolve directory mounts such that things
will just work and be portable with whatever enviornment you are running on.
This means that /tmp and /var/tmp are automatically shared into the container
as is /home. Additionally, if you are in a current directory that is not a 
system directory, Singularity will also try to bind that to your container.
</p>
<p>
There is a caveat in that a directory *must* already exist within your
container to serve as a mount point. If that directory does not exist,
Singularity will not create it for you! You must do that.
</p>


<h4 class="loud">What is the difference between full and relative paths?</h4>
<p>
See the above answer to "How are external filesystems and paths handled
in a Singularity Container?".
</p>


<h4 class="loud">How does Singularity handle manage networking?</h4>
<p>
Singularity does no network isolation because it is designed to run like any
other application on the system. It has all of the same networking privledges
as any program running as that user.
</p>


<h4 class="loud">Can I run X11 apps through Singularity?</h4>
<p>
Yes. This works exactly as you would expect it too.
</p>


<h4 class="loud">Can a Singularity container resolve GLIBC version mismatches?</h4>
<p>
Yes. Singularity containers contain their own library stack (including the
Glibc version that they require to run).
</p>


<h4 class="loud">Can a Singularity container be multi-threaded?</h4>
<p>
Yes. Singularity imposes no limitations on forks, threads or processes in
general.
</p>


<h4 class="loud">Can a Singularity container be suspended or checkpointed?</h4>
<p>
Yes and maybe respectively. Any Singularity application can be suspended using
standard Linux/Unix signals. Checkpointing requires some preloaded libraries
to be automatically loaded with the application but because Singularity escapes
the hosts library stack, the checkpoint libraries would not be loaded. If
however you wanted to make a Singularity container that can be checkpointed,
you would need to install the checkpoint libraries into the Singularity
container via the specfile.
</p>


<h4 class="loud">Are there any special requirements to use Singularity through a job scheduler?</h4>
<p>
No, Singularity containers can be run via any job scheduler with no
modifications to the scheduler configuration or architecture. This is because
Singularity containers are designed to be run like any application on the
system.
</p>


<h4 class="loud">Are there any special security concerns that Singularity introduces?</h4>
<p>
No and yes.
</p>
<p>
While Singularity containers always run as the user launching them, there are
some aspects of the container launch which requires escalation of privledges.
Once the container environment has been instantiated, all escalated privledges
are dropped completely, before running any programs within the container.
</p>
<p>
Additionally, there are precautions within the container context to mitigate
any esclation of privledges. This limits a user's ability to gain root control
once inside the container.
</p>


<h4 class="loud">What Linux distributions are you trying to get onboard?</h4>
<p>
All of them! Help us out by letting them know you want Singularity to be
included!
</p>


<h4 class="loud">What is the performance tradeoff when running an appication native or through Singularity?</h4>
<p>
So far we have not identified any appreciable regressions of performance (even
in parallel applications running across nodes with InfiniBand). There is a
small startup cost to create and teardown the container, which has been
measured to be anywhere from 10 - 20 thousandths of a second.
</p>
<p>
On a related note, what we have found so far is that not all operating systems
are created equal in terms of their build envrionment and optimized toolchains.
RedHat for example has a very optimal tool chain which they use for their
Enterprise product line and it is not available to other distributions (or
rebuilds) and thus their resulting binaries and libraries have been more
performant then other Linux distributions we have tested.
</p>


<h4 class="loud">Does Singularity work on multi-tenant HPC cluster environments?</h4>
<p>
Yes! HPC was one of the primary use cases in mind when Singularity was
created.
</p>
<p>
Most people that are currently integrating containers on HPC resources do it
by creating virtual clusters within the physical host cluster. This precludes
the virtual cluster from having access to the host cluster's high performance
fabric, file systems and other investments which make an HPC system high
performance.
</p>
</p>
Singularity on the other hand allows one to keep the high performance in High
Performance Computing by containerizing applications and supporting a runtime
which seemlessly interfaces with the host system and existing envrionments.
</p>


<h4 class="loud">Can I containerize my MPI application with Singularity and run it properly on an HPC system?</h4>
<p>
Yes! HPC was one of the primary use cases in mind when Singularity was
created.
</p>
<p>
While we know for a fact that Singularity can support multiple MPI
implementations, we have spent a considerable effort working with Open MPI
as well as adding a Singularity module into Open MPI (v2) such that running
at extreme scale will be as effecient as possible.
</p>
</p>
note: We have seen no major performance impact from running a job in a
Singularity container.
</p>


<h4 class="loud">What is the average air speed velocity of an unladen swallow?</h4>
<p>
Thanks Jason!
<br/>&nbsp;<br/>
<a target="_blank" href="http://style.org/unladenswallow/">http://style.org/unladenswallow/</a>
</p>

